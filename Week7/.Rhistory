HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined/sum(HEcombined)
chiOut <- chisq.test(HEcombined)
chiOut
chiOut$residuals
which.max(chiOut$residuals)
HEsmall <- HEcombined[c("Black","Blond"), c("Brown","Blue")]
HEsmall
chisq.test(HEsmall)
library(BayesFactor)
ctOut <- contingencyTableBF(HEsmall, sampleType="poisson", posterior=TRUE, iterations=10000)
summary(ctOut)
Row1 <- ctOut[,"lambda[1,1]"] / ctOut[,"lambda[1,2]"]
hist(Row1)
Row2 <- ctOut[,"lambda[2,1]"] / ctOut[,"lambda[2,2]"]
hist(Row2)
Diff<-Row1-Row2
hist(Diff)
hist(Diff)
abline(v=quantile(Diff,0.025))
abline(v=quantile(Diff,0.975))
# install.packages("BayesFactor") # Uncomment if not installed
library("BayesFactor")
data("CO2")
#?CO2
hist(CO2$conc)
hist(CO2$uptake)
plot(CO2$conc,CO2$uptake)
cor(CO2$conc,CO2$uptake)
cor.test(CO2$conc,CO2$uptake)
bfCorTest <- function (x,y) # Test r with BayesFactor
{
zx <- scale(x) # Standardize X
zy <- scale(y) # Standardize Y
zData <- data.frame(x=zx,rhoNot0=zy) # Put in a data frame
bfOut <- generalTestBF(x ~ rhoNot0, data=zData) # linear coefficient
mcmcOut <- posterior(bfOut,iterations=10000) # posterior samples
plot(mcmcOut[,"rhoNot0"])
print(summary(mcmcOut[,"rhoNot0"])) # Get the HDI for r
return(bfOut) # Return Bayes factor object
}
bfCorTest(CO2$conc,CO2$uptake)
# Subset the data
quebec <- CO2[CO2$Type=="Quebec", ]
missip <- CO2[CO2$Type=="Mississippi", ]
cor(quebec$conc,quebec$uptake)
cor.test(quebec$conc,quebec$uptake)
cor(missip$conc,missip$uptake)
cor.test(missip$conc,missip$uptake)
#install.packages("cocor")
library("cocor") # load package
install.packages("cocor")
library("cocor") # load package
cocor.indep.groups(r1.jk=cor(quebec$conc,quebec$uptake),
r2.hm=cor(missip$conc,missip$uptake),
n1=length(quebec$conc),
n2=length(missip$conc),
alternative="two.sided",
alpha=0.05, conf.level=0.95, null.value=0)
# install.packages("BayesFactor") # Uncomment if not installed
library("BayesFactor")
data("CO2")
?CO2
hist(CO2$conc)
hist(CO2$uptake)
plot(CO2$conc, CO2$uptake)
cor(CO2$conc, CO2$uptake)
cor.test(CO2$conc, CO2$uptake)
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=10000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
correlationBF(CO2$conc, CO2$uptake)
samples <- correlationBF(CO2$conc, CO2$uptake, posterior = TRUE, iterations = 1000)
plot(samples)
summary(samples[, "rho"])
# Subset the data
quebec <- CO2[CO2$Type=="Quebec", ]
missip <- CO2[CO2$Type=="Mississippi", ]
cor(quebec$conc,quebec$uptake)
cor.test(quebec$conc,quebec$uptake)
cor(missip$conc,missip$uptake)
cor.test(missip$conc,missip$uptake)
#install.packages("cocor")
require("cocor") # load package
cocor.indep.groups(r1.jk=cor(quebec$conc,quebec$uptake),
r2.hm=cor(missip$conc,missip$uptake),
n1=length(quebec$conc),
n2=length(missip$conc),
alternative="two.sided",
alpha=0.05, conf.level=0.95, null.value=0)
CO2
dim(CO2)
summary(CO2)
# install.packages("BayesFactor") # Uncomment if not installed
library("BayesFactor")
data("CO2")
?CO2
hist(CO2$conc)
hist(CO2$uptake)
plot(CO2$conc, CO2$uptake)
?CO2
cor(CO2$conc, CO2$uptake)
cor.test(CO2$conc, CO2$uptake)
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=10000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
dim(CO2)
options(scipen=999)  # turn-off scientific notation like 1e+48
cor(CO2$conc, CO2$uptake)
cor.test(CO2$conc, CO2$uptake)
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=10000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
correlationBF(CO2$conc, CO2$uptake)
samples <- correlationBF(CO2$conc, CO2$uptake, posterior = TRUE, iterations = 1000)
plot(samples)
summary(samples[, "rho"])
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=100000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=5000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
bfCorTest <- function(x, y) {
zx <- scale(x)
zy <- scale(y)
zData <- data.frame(x=zx, rhoNot0=zy)
bfOut <- generalTestBF(x ~ rhoNot0, data=zData)
mcmcOut <- posterior(bfOut, iterations=100000)
plot(mcmcOut[, "rhoNot0"])
print(summary(mcmcOut[, "rhoNot0"]))
return(bfOut)
}
bfCorTest(CO2$conc,CO2$uptake)
# Subset the data
quebec <- CO2[CO2$Type=="Quebec", ]
missip <- CO2[CO2$Type=="Mississippi", ]
cor(quebec$conc,quebec$uptake)
cor.test(quebec$conc,quebec$uptake)
cor(missip$conc,missip$uptake)
cor.test(missip$conc,missip$uptake)
#install.packages("cocor")
require("cocor") # load package
cocor.indep.groups(r1.jk=cor(quebec$conc,quebec$uptake),
r2.hm=cor(missip$conc,missip$uptake),
n1=length(quebec$conc),
n2=length(missip$conc),
alternative="two.sided",
alpha=0.05, conf.level=0.95, null.value=0)
?HairEyeColor
dim(HairEyeColor)
str(HairEyeColor)
HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined/sum(HEcombined)
chiOut <- chisq.test(HEcombined)
chiOut
HEsmall <- HEcombined[c("Black","Red"), c("Brown","Hazel")]
library(BayesFactor)
ctOut <- contingencyTableBF(HEsmall, sampleType="poisson", posterior=TRUE, iterations=10000)
summary(ctOut)
dim(HairEyeColor)
str(HairEyeColor)
summary(HairEyeColor)
chiOut <- chisq.test(HEcombined)
chiOut
chiOut$residuals
HEsmall <- HEcombined[c("Black","Red"), c("Brown","Hazel")]
HEsmall
HEsmall <- HEcombined[c("Blond","Brown"), c("Blond","Blue")]
HEsmall <- HEcombined[c("Blond","Brown"), c("Red","Blue")]
HEsmall <- HEcombined[c("Blond","Brown"), c("Red","Blue")]
HEcombined
HEsmall <- HEcombined[c("Blond","Red"), c("Brown","Blue")]
HEcombined
HEsmall <- HEcombined[c("Blond","Red"), c("Brown","Blue")]
HEcombined
HEsmall
library(BayesFactor)
ctOut <- contingencyTableBF(HEsmall, sampleType="poisson", posterior=TRUE, iterations=10000)
summary(ctOut)
contingencyTableBF
library(BayesFactor)
ctOut <- contingencyTableBF(HEsmall, sampleType="poisson", posterior=TRUE, iterations=10000)
summary(ctOut)
Row1 <- ctOut[,"lambda[1,1]"] / ctOut[,"lambda[1,2]"]
hist(Row1)
Row2 <- ctOut[,"lambda[2,1]"] / ctOut[,"lambda[2,2]"]
hist(Row2)
?HairEyeColor
dim(HairEyeColor)
str(HairEyeColor)
summary(HairEyeColor)
HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined
# ?HairEyeColor
# dim(HairEyeColor)
# str(HairEyeColor)
summary(HairEyeColor)
HEcombined <- HairEyeColor[ , ,1] + HairEyeColor[ , ,2]
HEcombined
